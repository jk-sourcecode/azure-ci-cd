node {

    def PACKAGE_VERSION = sh(returnStdout: true, script: /sed -nE 's\/^\s*"version": "(.*?)",$\/\1\/p' package.json/).trim()

    stage('Pull') {
            checkout scm
        }

    stage('Build') {
        echo 'Building docker image'
        echo """building version-${PACKAGE_VERSION}"""
        sh """docker build -t Test/secure-api-jwt:version-${PACKAGE_VERSION} ."""
    }
}